<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-09-23 周一 21:12 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org4c284aa">走入并行世界</a></li>
<li><a href="#org07cdd07">Java并行程序基础</a></li>
<li><a href="#orgc85c4c7">JDK并发包</a>
<ul>
<li><a href="#org9014f3a">Java并发容器</a></li>
</ul>
</li>
<li><a href="#org0a35450">锁的优化及注意事项</a></li>
<li><a href="#orgf84dd97">并行模式与算法</a>
<ul>
<li><a href="#orgdabf159">NIO</a></li>
<li><a href="#org58c7b73">AIO</a></li>
</ul>
</li>
<li><a href="#org82c462d">Java 8/9/10与并发</a>
<ul>
<li><a href="#org6ad406e">Java9</a></li>
</ul>
</li>
<li><a href="#org0b5531c">使用Akka构建高并发程序</a></li>
<li><a href="#org99db923">并行程序调试</a></li>
<li><a href="#org4353722">多线程优化示例——Jetty核心代码分析</a></li>
</ul>
</div>
</div>
<div id="outline-container-org4c284aa" class="outline-2">
<h2 id="org4c284aa">走入并行世界</h2>
<div class="outline-text-2" id="text-org4c284aa">
<p>
同步（synchronous）调用在返回之后，调用的函数执行完毕。异步（asynchronous）调用在返回之后，被调用的函数未必执行完毕，也可能尚未执行，或者在执行中。
</p>


<p>
并行（parallel）是指多个任务同时执行。并发（concurrency）指的是由于任务调度，各个任务的部分逻辑交替执行，从任务自身来看，各任务是同时执行的。
</p>


<p>
临界区（critical section）是一段特殊的代码，同一时刻，系统中只能有一个任务在运行这段代码。否则系统将出现错误。
</p>


<p>
如果系统无法为任务分配资源（比如进入临界区），任务必须等待。这时系统有两种方式来处理任务，一是将任务使用的线程挂起，待资源就绪后，继续执行该线程。这种方式叫做阻塞（blocking）。二是将任务的上下文保存起来，让线程执行其他任务。等到资源就绪后，分配一个线程，重建任务上下文并继续执行。这个方式叫做非阻塞（non-blocking）。
</p>


<p>
死锁（deadlock）、
、活锁（livelock）。
</p>

<p>
饥饿（starvation）是指一个任务迟迟得不到资源而无法执行。
</p>

<p>
并发级别：
</p>

<ul class="org-ul">
<li>阻塞。</li>
<li>无饥饿。资源分配是公平的。通常通过队列实现。</li>
<li>Obstruction-free。类似乐观锁。？</li>
<li>无锁。</li>
<li>无等待。任务在有限步内完成。</li>
</ul>

<p>
两个定律：
</p>
<ul class="org-ul">
<li>Amdahl定律。</li>
</ul>
<p>
加速比=1/(F+(1-F)*1/n)
F是程序中只能串行执行的比例，n是处理器数量。
</p>
<ul class="org-ul">
<li>Gustafson定律。？</li>
</ul>
</div>
</div>

<div id="outline-container-org07cdd07" class="outline-2">
<h2 id="org07cdd07">Java并行程序基础</h2>
<div class="outline-text-2" id="text-org07cdd07">
<p>
Java线程会1比1映射为操作系统线程。在JVM的角度看，Java线程有6种状态（java.lang.Thread.State）：
</p>
<ul class="org-ul">
<li>NEW。已经创建Thread对象，没有执行start()方法。</li>
<li>RUNNABLE。运行中或位于运行队列。</li>
<li>BLOCKED。等待synchronized同步。</li>
<li>WAITING。等待。</li>
<li>TIMED<sub>WAITING</sub>。带超时等待。</li>
<li>TERMINATED。终止。</li>
</ul>
</div>
</div>

<div id="outline-container-orgc85c4c7" class="outline-2">
<h2 id="orgc85c4c7">JDK并发包</h2>
<div class="outline-text-2" id="text-orgc85c4c7">
<p>
java.util.concurrent.lock.ReentrantLock有一个具有一个boolean型参数的构造函数，如果参数值为true，将构造一个公平锁。
</p>


<p>
p113
</p>




<p>
LockSupport的静态方法park()可以阻塞线程。这个方法比Thread.suspend()更安全。
</p>

<p>
park()为每个线程准备了信号量。park()和unpark()会针对信号量操作。
</p>

<p>
如果遇到中断，park()会直接返回，而不是抛出InterruptedException异常，但是从Thread.interrupted()可以观察到中断。
</p>


<p>
线程池：
newFixedThreadPool(int count);
newSingleThreadExecutor();
newCachedThreadPool();
newSingleThreadScheduledExecutor();
newScheduledThreadPool(int coreSize);
</p>

<p>
ScheduledExecutorService
schedule(Runnable command, long delay, TimeUnit unit);
scheduleAtFixedRate(Runnable command, long initialDelay, long period, TimeUnit unit);
scheduleWithFixedDelay(Runnable command, long initialDelay, long period, TimeUnit unit);
</p>

<p>
这些类都是封装了ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnale&gt; workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler);
</p>

<p>
BlockingQueue: 
  SynchronousQueue 容量为1的队列
  ArrayBlockingQueue
  LinkedBlockingQueue
  PriorityBlockingQueue
</p>

<p>
拒绝策略有：
  AbortPolicy 抛出异常
  CallerRunsPolicy 在调用者线程中运行
  DiscardOldestPolicy
  DiscardPolicy
拒绝策略接口是
public void rejectedExecution(Runnable r, ThreadPoolExecutor executor);
</p>

<p>
ThreadFactory接口是
Thread newThread(Runnable r);
</p>

<p>
ThreadPoolExecutor提供了afterExecute()、beforeExecute()和terminate()3个接口。
</p>

<p>
Java Concurrency in Practice一书中给出的估算线程池大小的公式：
</p>

<p>
线程数=Ncpu*Ucpu*(1+W/C)
Ncpu：CPU数
Ucpu：目标CPU使用率，0 &le; Ucpu &le; 1
W：等待时间
C：计算时间
</p>

<p>
Executor的execute()方法可以打印异常堆栈，而submit()方法不行。（？使用future的execption.getCause()可行吗？）
</p>



<p>
&lt;T&gt; ForkJoinTask&lt;T&gt; submit(ForkJoinTask&lt;T&gt; task)
fork()
join()
</p>
</div>

<div id="outline-container-org9014f3a" class="outline-3">
<h3 id="org9014f3a">Java并发容器</h3>
<div class="outline-text-3" id="text-org9014f3a">
<p>
ConcurrentHashMap
CopyOnWriteArrayList
ConcurrentLinkedQueue
BlockingQueue
ConcurrentSkipListMap
Collections.synchronizedMap(Map)
Collections.synchronizedList(List)
</p>

<p>
ConcurrentLinkedQueue是一个双向链表，采用CAS完成插入和删除。
ConcurrentSkipListMap是一个关联数组，按键的顺序排列，采用CAS完成插入删除。
</p>
</div>
</div>
</div>

<div id="outline-container-org0a35450" class="outline-2">
<h2 id="org0a35450">锁的优化及注意事项</h2>
<div class="outline-text-2" id="text-org0a35450">
<ul class="org-ul">
<li>降低锁的粒度。通常ConcurrentHashMap分为16个段，键按照散列值分布于不同的段中。在控制并发时，ConcurrentHashMap只对具体的段加锁。</li>
<li>使用读写锁代替互斥锁，提高读取速度和并发能力。</li>
</ul>

<p>
使用逃逸分析（-XX:+DoEscapgeAnalysis）可以找到不必要的加锁。使用-XX:+EliminateLocks可以消除锁。
</p>

<p>
Bootstrap类加载器没有Java对象，因此试图获得这个类加载器会返回null。
</p>

<p>
atomic提供了几个高效的并发数据结构
AtomicInteger
AtomicIntegerArray
AtomicReference
AtomicStampedReference
AtomicIntegerFieldUpdater
AtomicLongFieldUpdater
AtomicReferenceFieldUpdater
</p>

<p>
AtomicReference&lt;Integer&gt; money = new AtomicReference&lt;Integer&gt;();
money.set(19);
Integer m = money.get();
money.compareAndSet(m, m + 20);
</p>

<p>
AtomicReference容易出现ABA问题。为此又提供了AtomicStampedReference：
AtomicStampedReference&lt;Integer&gt; money = new AtomicStampedReference&lt;Integer&gt;(19, 0);
int stamp = money.getStamp();
Integer amount = money.getReference();
money.compareAndSet(amount, amount + 20, stamp, stamp + 1);
</p>
</div>
</div>

<div id="outline-container-orgf84dd97" class="outline-2">
<h2 id="orgf84dd97">并行模式与算法</h2>
<div class="outline-text-2" id="text-orgf84dd97">
<p>
一种单例写法：
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #a020f0;">public</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Singleton</span> {
    <span style="color: #a020f0;">private</span> <span style="color: #0000ff;">Singleton</span>(){}
    <span style="color: #a020f0;">private</span> <span style="color: #a020f0;">static</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">SingletonHolder</span>() {
        <span style="color: #a020f0;">private</span> <span style="color: #a020f0;">static</span> <span style="color: #228b22;">Singleton</span> <span style="color: #a0522d;">instance</span> = <span style="color: #a020f0;">new</span> <span style="color: #228b22;">Singleton</span>();
    }
    <span style="color: #a020f0;">public</span> <span style="color: #a020f0;">static</span> <span style="color: #228b22;">Singleton</span> <span style="color: #0000ff;">getInstancee</span>() {
        <span style="color: #a020f0;">return</span> SingletonHolder.instance;
    }
}
</pre>
</div>
</div>



<div id="outline-container-orgdabf159" class="outline-3">
<h3 id="orgdabf159">NIO</h3>
<div class="outline-text-3" id="text-orgdabf159">
<p>
Channel是一个字节流。SelectableChannel是可以由Selector管理的字节流。一个Selector可以管理多个SelectableChannel，当某个SelectableChannel就绪后，通知应用程序。
</p>
</div>
</div>


<div id="outline-container-org58c7b73" class="outline-3">
<h3 id="org58c7b73">AIO</h3>
<div class="outline-text-3" id="text-org58c7b73">
<p>
AsynchronousServerSocketChannel
</p>
</div>
</div>
</div>

<div id="outline-container-org82c462d" class="outline-2">
<h2 id="org82c462d">Java 8/9/10与并发</h2>
<div class="outline-text-2" id="text-org82c462d">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #008b8b;">@FunctionalInterface</span>
<span style="color: #a020f0;">public</span> <span style="color: #a020f0;">static</span> <span style="color: #a020f0;">interface</span> <span style="color: #228b22;">IntHandler</span> {
     <span style="color: #228b22;">void</span> <span style="color: #0000ff;">handle</span>(<span style="color: #228b22;">int</span> <span style="color: #a0522d;">i</span>);
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #a020f0;">public</span> <span style="color: #228b22;">interfae</span> <span style="color: #a0522d;">IHorse</span> {
    <span style="color: #228b22;">void</span> <span style="color: #0000ff;">eat</span>();
    <span style="color: #a020f0;">default</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">run</span>() { ... }
}

<span style="color: #a020f0;">public</span> <span style="color: #a020f0;">interface</span> <span style="color: #228b22;">IDonkey</span> {
    <span style="color: #a020f0;">default</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">run</span>() { ... }
}

<span style="color: #a020f0;">public</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Mule</span> <span style="color: #a020f0;">implements</span> <span style="color: #228b22;">IHorse</span>, <span style="color: #228b22;">IDonkey</span> {
    <span style="color: #a020f0;">public</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">run</span>() {
        IHorse.<span style="color: #a020f0;">super</span>.run();
    }
}
</pre>
</div>

<p>
方法引用：
静态方法 ClassName::methodName
实例方法 instance::methodName
超类实例方法 super::methodName
类型实例方法 ClassName::methodName
构造方法 Class::new
数组构造方法 TypeName[]::new
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #228b22;">int</span>[] <span style="color: #a0522d;">a</span> = {1,2,3};
Arrays.stream(a).forEach(...);
</pre>
</div>

<p>
.parallel()并行。
.mapToInt()
Arrays.parallelSort(arr);
CompleableFuture
</p>

<p>
StampedLock乐观锁。
LongAdder。比AtomicLong更好。
LongAccumulator。
</p>

<p>
ConcurrentHashMap
forEach
reduce
computeIfAbsent
search
</p>
</div>

<div id="outline-container-org6ad406e" class="outline-3">
<h3 id="org6ad406e">Java9</h3>
<div class="outline-text-3" id="text-org6ad406e">
<p>
Java 9引入了反应式编程。在反应式编程中，两个主要的概念是publisher和subscriber。publisher负责发布数据，subscriber负责处理数据。这些接口定义如下：
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #008b8b;">@FunctionalInterface</span>
<span style="color: #a020f0;">public</span> <span style="color: #a020f0;">static</span> <span style="color: #a020f0;">interface</span> <span style="color: #008b8b;">Flow</span>.<span style="color: #228b22;">Publisher</span>&lt;<span style="color: #228b22;">T</span>&gt; {
    <span style="color: #a020f0;">public</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">subscribe</span>(<span style="color: #008b8b;">Flow</span>.<span style="color: #228b22;">Subscriber</span>&lt;? <span style="color: #a020f0;">super</span> <span style="color: #228b22;">T</span>&gt; <span style="color: #a0522d;">subscriber</span>);
}

<span style="color: #a020f0;">public</span> <span style="color: #a020f0;">static</span> <span style="color: #a020f0;">interface</span> <span style="color: #008b8b;">Flow</span>.<span style="color: #228b22;">Subscriber</span>&lt;<span style="color: #228b22;">T</span>&gt; {
    <span style="color: #a020f0;">public</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">onSubscribe</span>(<span style="color: #008b8b;">Flow</span>.<span style="color: #228b22;">Subscription</span> <span style="color: #a0522d;">subscription</span>);
    <span style="color: #a020f0;">public</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">onNext</span>(<span style="color: #228b22;">T</span> <span style="color: #a0522d;">item</span>); <span style="color: #b22222;">// </span><span style="color: #b22222;">&#38656;&#35201;&#35843;&#29992;subscription.request(batchSize)</span>
    <span style="color: #a020f0;">public</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">onError</span>(<span style="color: #228b22;">Throwable</span> <span style="color: #a0522d;">throwable</span>);
    <span style="color: #a020f0;">public</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">onComplete</span>();
}

<span style="color: #a020f0;">public</span> <span style="color: #a020f0;">static</span> <span style="color: #a020f0;">interface</span> <span style="color: #008b8b;">Flow</span>.<span style="color: #228b22;">Subscription</span> {
    <span style="color: #a020f0;">public</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">request</span>(<span style="color: #228b22;">long</span> <span style="color: #a0522d;">n</span>);
    <span style="color: #a020f0;">public</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">cancel</span>();
}

<span style="color: #a020f0;">public</span> <span style="color: #a020f0;">static</span> <span style="color: #a020f0;">interface</span> <span style="color: #008b8b;">Flow</span>.<span style="color: #228b22;">Processor</span>&lt;<span style="color: #228b22;">T</span>,<span style="color: #228b22;">R</span>&gt; <span style="color: #a020f0;">extends</span> <span style="color: #008b8b;">Flow</span>.<span style="color: #228b22;">Subscriber</span>&lt;<span style="color: #228b22;">T</span>&gt;, <span style="color: #008b8b;">Flow</span>.<span style="color: #228b22;">Publisher</span>&lt;<span style="color: #228b22;">R</span>&gt; {
}
</pre>
</div>

<p>
SubmissionPublisher
</p>
</div>
</div>
</div>

<div id="outline-container-org0b5531c" class="outline-2">
<h2 id="org0b5531c">使用Akka构建高并发程序</h2>
<div class="outline-text-2" id="text-org0b5531c">
<p>
消息投递的三种策略：
</p>
<ul class="org-ul">
<li>至多一次</li>
<li>至少一次</li>
<li>只有一次</li>
</ul>
</div>
</div>

<div id="outline-container-org99db923" class="outline-2">
<h2 id="org99db923">并行程序调试</h2>
</div>

<div id="outline-container-org4353722" class="outline-2">
<h2 id="org4353722">多线程优化示例——Jetty核心代码分析</h2>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2019-09-23 周一 21:12</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
