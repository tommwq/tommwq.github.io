<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-09-23 周一 21:12 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>金融计量学笔记</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">金融计量学笔记</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgbf24520">金融计量学初步</a></li>
<li><a href="#org2dee430">差分方程、滞后运算与动态模型</a></li>
<li><a href="#org507ca15">平稳AR模型</a></li>
<li><a href="#org76ea2f2">平稳ARMA模型</a></li>
<li><a href="#org91064fa">试验</a></li>
</ul>
</div>
</div>
<p>
《金融计量学：时间序列分析视角》张成思
</p>

<div id="outline-container-orgbf24520" class="outline-2">
<h2 id="orgbf24520">金融计量学初步</h2>
<div class="outline-text-2" id="text-orgbf24520">
<p>
金融计量学的主要目的是对金融现象进行建模和预测。金融现象的发生具有随机性，为了便于建模，我们用随机变量来描述金融现象（或其中的某一方面）。
由于金融现象会随着时间发生变化，时间序列成为金融计量学的重要工具。时间序列是一个随机变量在不同时点的值，按照时间排序而成的序列。
</p>


<p>
提到随机变量，我们知道它的值（观测值）具有一定的随机性，或者说服从某个分布。
在时间序列中，随机变量（观测值）随着时间发生变化。在这个过程中，随机变量所服从的分布是否发生了变化呢？由此可以看出，时间序列收到双重因素的影响：
</p>

<ul class="org-ul">
<li>在某一时刻，随机变量的值服从一个具体的分布。</li>
<li>在不同时刻，随机变量所服从的分布也会发生变化。</li>
</ul>

<p>
在金融计量学中，我们使用到的随机变量都是和金融现象相关联的，比如价格、收益率等等。下面我们来了解一下这些随机变量的定义。
</p>

<p>
假设P<sub>t</sub> 是某一金融产品在时刻t的价格，那么简单净收益率（simple net return）定义为：
</p>


<p>
R<sub>t</sub> = (P<sub>t</sub> - P<sub>t-1</sub>)/P<sub>t-1</sub> &times; 100%
</p>

<p>
简单净收益率是日常生活中经常使用的，在金融计量学中，更多的使用连续复合收益率（continuous compounding return）：
</p>

<p>
r<sub>t</sub> = ln(P<sub>t</sub>/P<sub>t-1</sub>) &times; 100%
</p>

<p>
使用连续复合收益率可以简化计算，比如在多期（multi-period）的情况下，连续复合收益率为：
</p>

<p>
r<sub>t</sub>(k) = ln[(P<sub>t</sub>/P<sub>t-1</sub>)(P<sub>t-1</sub>/P<sub>t-2</sub>) &ctdot; (P<sub>t-k+1</sub>/P<sub>t-k</sub>)] = r<sub>t</sub> + r<sub>t-1</sub> + &ctdot; + r<sub>t-k+1</sub>
</p>

<p>
不同金融产品具有不同的周期，为了便于比较，通常会采用一种叫做年化（annualized）的策略，将收益率统一折算。假设P<sub>t是季度价格指数</sub>，那么年华收益率就是
</p>

<p>
[(P<sub>t</sub>/P<sub>t-1</sub>)<sup>4</sup>-1] &times; 100%
</p>


<p>
下面我们来学习随机过程。首先考察一元线性回归方程：
</p>

<p>
y<sub>t</sub> = c + &beta; &times; x<sub>t</sub> + &epsilon;<sub>t</sub>, &epsilon;<sub>t</sub> &sim; N(0, &sigma;<sup>2</sup>)
</p>

<p>
在这里我们要求误差项 &epsilon;<sub>t</sub> 服从正态分布。实际上，这个条件可以放宽，只需要 &epsilon;<sub>t</sub> 服从独立一致性分布。独立一致性分布（independently and identically distributed，缩写i.i.d.）表示在各个时刻，随机变量都服从完全一致的分布特征，并且是独立的。因此，回归方程可以写成：
</p>

<p>
y<sub>t</sub> = c + &beta; &times; x<sub>t</sub> + &epsilon;<sub>t</sub>, &epsilon;<sub>t</sub> &sim; i.i.d.(0, &sigma;<sup>2</sup>)
</p>

<p>
现在我们来学习随机过程。随机过程是定义在一个概率空间的一组具有相同随机特性的随机变量。
</p>


<p>
随机变量的特性由随机分布决定，下面来学习随机分布的相关概念。假设X和Y是两个以向量形式组织的随机变量，我们用 Pr(X &sub; R<sup>m</sup>, Y &sub; R<sup>n</sup>) 表示X和Y的概率向量。
对于 R<sup>m</sup> 和 R<sup>n</sup> 中的点x和y，公式：
</p>


<p>
F<sub>X.Y</sub>(x, y; &theta;) = Pr(X &le; x, Y &le; y)
</p>

<p>
定义了X和Y的联合分布（joint distribution）。其中 &theta; 是联合分布函数的参数。如果我们能够找打一个函数 f<sub>x.y</sub>(x,y; &theta;) 满足：
</p>

<p>
F<sub>X,Y</sub>(x,y;&theta;) = &int;<sub>-inf</sub><sup>x</sup> &int;<sub>-inf</sub><sup>y</sup> f<sub>x.y</sub>(w,z;&theta;)dzdw
</p>

<p>
这个函数f<sub>x.y</sub>就叫做X和Y的联合概率密度函数（joint probability density function）。
</p>


<p>
另一个和联合分布函数相关的函数是边际分布（marginal distribution）函数，它的定义如下：
</p>

<p>
F<sub>X</sub>(x;&theta;) = F<sub>X.Y</sub>(x,+inf, +inf, &ctdot; ; &theta;)
</p>

<p>
如果X是一维的，边际分布就变成了我们熟悉的形式：
</p>

<p>
F<sub>X</sub>(x;&theta;) = Pr(X &le; x; &theta;)
</p>

<p>
这个函数也叫做X的累积分布函数（cumulative distribution function，CDF）。CDF在计算统计量时非常有用。
</p>


<p>
和随机分布相关的还有一个概念叫做条件分布：
</p>

<p>
F<sub>X|Y &le; y</sub>(x; &theta;) = Pr(X &le; x, Y &le; y) / Pr(Y &le; y)
</p>

<p>
类似的，有：
</p>

<p>
f<sub>x|y</sub>(x;&theta;) = f<sub>x.y</sub>(x,y;&theta;) / f<sub>y</sub>(y;&theta;)
</p>

<p>
f<sub>y</sub>(y;&theta;) = &int;<sub>-inf</sub><sup>+inf</sup>f<sub>x.y</sub>(x,y;&theta;)dx
</p>


<p>
第一个函数通常用于最大似然法（maximum likelihood estimator，MLE）。MLE有效的前提条件之一是，对随机变量的分布有严格的假设。
</p>


<p>
如果满足：
</p>

<p>
f<sub>x|y</sub>(x;&theta;) = f<sub>x</sub>(x;&theta;)
</p>

<p>
我们称X和Y是统计独立的。
</p>


<p>
金融计量学里一个非常重要的概念是矩（moments）。随机变量X的n阶矩定义为：
</p>

<p>
E[(x-&mu;)<sup>n</sup>\ = &int;<sub>-inf</sub><sup>+inf</sup>(x-&mu;)<sup>nf</sup>(x)dx
</p>

<p>
其中\mu是X的均值，E(&sdot;)是期望操作。1阶矩是均值或期望，通常用\mu表示。2阶矩是方差，用&sigma;<sup>2表示</sup>。
3阶矩叫偏度（skewness），描述了分布的非对称程度。如果偏度大于0，分布成右侧长尾。如果偏度小于0，分布成左侧长尾。
4阶矩叫（尾）峰度，描述了分布的尖峰程度。对于正态分布，偏度是0，峰度是3。这个特征可以判断一个分布是否服从正态分布。比如Jarque-Bera检验正是利用了这一点。
Jarque-Beta的检验统计量为：
</p>

<p>
Jarque-Bera = [(N-k) / 6] * [S<sup>2</sup> + (K-3)<sup>2</sup>/4]
</p>

<p>
其中，N是样本大小，S是偏度，K是峰度，k是解释变量数量，原假设是待检验随机变量服从正态分布。
</p>


<p>
在实际工作中，我们是通过样本来推测全体。
我们无法获得全体的实际期望，需要根据样本来推测。假设T是随机变量 &epsilon;<sub>t</sub> 的样本观测值的数量，样本均值定义为：
</p>

<p>
&mu;=1/T &times; &sum;<sub>t-1</sub><sup>T</sup> x<sub>t</sub>
</p>

<p>
而样本方差为：
</p>

<p>
&sigma;<sup>2</sup> = 1/(T-1) &times; &sum;<sub>t=1</sub><sup>T</sup> (x<sub>t</sub> - &mu;)<sup>2</sup>
</p>
</div>
</div>


<div id="outline-container-org2dee430" class="outline-2">
<h2 id="org2dee430">差分方程、滞后运算与动态模型</h2>
<div class="outline-text-2" id="text-org2dee430">
<p>
差分方程在时序分析的重要基础。我们先观察一个简单的差分方程：
</p>

<p>
y<sub>t</sub> = &alpha; y<sub>t-1</sub> + &epsilon;<sub>t</sub>
</p>

<p>
从这个例子可以看出，差分方程描述的是一个序列，序列中的项依赖于前序某个项。在上面的例子中，y<sub>t仅依赖于y</sub><sub>t-1</sub>，这样的差分方程叫做一阶差分方程，y<sub>t-1</sub>叫做一次滞后期。
</p>


<p>
对于上面的一阶差分方程，如果我们在等号两边同时减去 y<sub>t-1</sub> ，可以得到：
</p>

<p>
y<sub>t</sub> - y<sub>t-1</sub> = (&alpha; - 1)y<sub>t-1</sub> + &epsilon;<sub>t</sub>
</p>

<p>
我们把 y<sub>t</sub> - y<sub>t-1</sub> 记为 &Delta; y<sub>t</sub> 。 &Delta; y<sub>t</sub> 的差分记为：
</p>

<p>
&Delta;<sup>2</sup> y<sub>t</sub> = &Delta; ( &Delta; y<sub>t</sub> ) = (y<sub>t</sub> - y<sub>t-1</sub>) - (y<sub>t-1</sub> = y<sub>t-2</sub>)
</p>

<p>
现在我们来考察如何计算 y<sub>t</sub> 具体的值。根据定义不断循环展开可以得到：
</p>

<p>
y<sub>t</sub> = &alpha;<sup>t</sup> y<sub>0</sub> + &sum;<sub>i=0</sub><sup>t-1</sup> &alpha;<sup>i</sup> &epsilon;<sub>t-i</sub>
</p>

<p>
从这个公式可以看出， 构成 y<sub>t</sub> 值的两个部分都收到 &alpha; 的影响。如果 | &alpha; | &lt; 1 ，随着t的增加， &alpha;<sup>t</sup> y<sub>0</sub> 这一项趋于极限0，
 &sum;<sub>i=0</sub><sup>t-1</sup> &alpha;<sup>i</sup> &epsilon;<sub>t-i</sub> 成为影响 y<sub>t</sub> 的主要因素。这时称为时序序列变量 y<sub>t</sub> 是收敛（convergence）序列。
反之，如果 | &alpha; | &gt; 1 ， y<sub>t</sub> 将无法表达为 &epsilon;<sub>t</sub> 的线性表达式，差分方程的解不存在。
如果 | &alpha; | = 1 呢？这时的差分方程叫做随机游走过程（random walk process）。随机游走过程将在后面介绍。
</p>

<p>
随机扰动项 &epsilon;<sub>t</sub> 也叫做冲击因素。根据差分方程可以知道， &epsilon;<sub>t</sub> 会影响到 y<sub>t</sub> 和 y<sub>t</sub> 后面的项，这个影响有多大呢？我们定义一个名词来衡量这种影响，这个概念叫做动态乘数（dynamic multiplier）：
</p>

<p>
动态乘数 = d<sup>2</sup>y<sub>t+j</sub> / d&epsilon;<sub>t</sub>, j  = 0, 1, 2, &ctdot;
</p>

<p>
j=0时的动态乘数比较重要，叫做影响乘数（impact multiplier）。
</p>

<p>
跳过：公式 2.15 2.16，章节 2.2.2。
</p>


<p>
一阶差分方程可以很容易的扩展到高阶差分方程：
</p>

<p>
y<sub>t</sub> = &alpha;<sub>1</sub> y<sub>t-1</sub> + &alpha;<sub>2</sub> y<sub>t-2</sub> + &ctdot; + &alpha;<sub>p</sub> y<sub>t-p</sub> + &epsilon;<sub>t</sub>
</p>

<p>
跳过：2.3节。
</p>

<p>
为了简化公式，我们引入滞后算子（lag operator）。滞后算子用L表示，其计算规则如下：
</p>

<p>
Ly<sub>t</sub> = y<sub>t-1</sub>
</p>

<p>
L<sup>2</sup> y<sub>t</sub> = y<sub>t-2</sub>
</p>

<p>
&ctdot;
</p>

<p>
L<sup>p</sup> y<sub>t</sub> = y<sub>t-p</sub>
</p>

<p>
使用滞后算子，我们可以把二阶差分方程
</p>

<p>
y<sub>t</sub> = &alpha;<sub>1</sub> y<sub>t-1</sub> + &alpha;<sub>2</sub> y<sub>t-2</sub> + &epsilon;<sub>t</sub>
</p>

<p>
写成
</p>

<p>
y<sub>t</sub> = &alpha;<sub>1</sub> L y<sub>t</sub> + &alpha;<sub>2</sub> L<sup>2</sup> y<sub>t</sub> + &epsilon;<sub>t</sub>
</p>

<p>
由于L满足结合律和交换律，上式可以写成
</p>

<p>
(1 - &alpha;<sub>1</sub> L - &alpha;<sub>2</sub> L<sup>2</sup>) &times; y<sub>t</sub> = &epsilon;<sub>t</sub>
</p>

<p>
其中的(1 - &alpha;<sub>1</sub> L - &alpha;<sub>2</sub> L<sup>2</sup>)叫做滞后算子多项式。通常把滞后算子多项式写成 &alpha; (L) 。
</p>

<p>
简单的算术运算可以施加到算子上，得到一个新的算子。L算子的一个重要的特点是，对于一个绝对值小于1的实数 &alpha;，当n趋于无穷大时，下面的等式成立
</p>

<p>
(1 - &alpha; L)<sup>-1</sup> = 1 + &alpha; L + &alpha;<sup>2</sup> L<sup>2</sup> + &ctdot; 
</p>
</div>
</div>



<div id="outline-container-org507ca15" class="outline-2">
<h2 id="org507ca15">平稳AR模型</h2>
<div class="outline-text-2" id="text-org507ca15">
<p>
假设T是一个时间域，对于T中的每个参数t，有一个取值于确定集合W的随机变量 Y<sub>t</sub> (s)，其中s属于某个特定的样本区间。
对于给定的t，Y<sub>t</sub> (s) 是一个随机变量，对于给定的样本s， Y<sub>t</sub> (s) 是s上的一组实现值。这时，集合{Y<sub>t</sub> (s), t &isin; T}就是一个随机过程。
</p>

<p>
假设 y<sub>t</sub> 是一个随机变量，我们用
</p>

<p>
&gamma;<sub>j</sub> = E[y<sub>t</sub> - E(y<sub>t</sub>)][y<sub>t-j</sub> - E(y<sub>t-j</sub>)], j = 0, &plusmn; 1 &ctdot;
</p>

<p>
来描述 y<sub>t</sub> 的自相关性。类似的，y<sub>t</sub> 于 y<sub>t-j</sub> 的自相关函数（autocorrelation function，AFC）定义为
</p>

<p>
&rho;<sub>j</sub> = cov(y<sub>t</sub>, y<sub>t-j</sub>) / [std(y<sub>t</sub>) &times; std(y<sub>t-j</sub>)] 
</p>


<p>
如果一个时间序列中，随着t的变化，随机变量所具备的随机性质不变，这个时间序列就叫做是平稳（stationarity）的。
最常用到的一种平稳性是弱（weakly）平稳性，也叫做协方差平稳（covariance-stationarity）或二阶平稳（second-order stationarity）。
二阶平稳要求随机变量的均值、方差和自协方差不变：
</p>

<p>
E(y<sub>t</sub>) = &mu;
</p>

<p>
var(y<sub>t</sub>) = &sigma;<sup>2</sup>
</p>

<p>
&gamma;<sub>j</sub> = E[y<sub>t</sub>-&mu;][y<sub>t-j</sub>-&mu;]
</p>



<p>
白噪音过程（white noise process）是金融时序分析中常用的平稳过程之一。白噪音过程的所有随机序列彼此相互独立，并且均值为0，方差为常数：
</p>

<p>
E(y<sub>t</sub>) = 0
</p>

<p>
var(y<sub>t</sub>) = &gamma;<sub>0</sub> = &sigma;<sup>2</sup>
</p>

<p>
cov(y<sub>t</sub>, y<sub>t-j</sub>) = 0, j &ne; 0
</p>


<p>
白噪声是无记忆的。如果一个白噪声过程服从正态分布：
</p>

<p>
{y<sub>1</sub>, y<sub>2</sub>, &ctdot;, y<sub>T</sub>}, y<sub>t</sub> &sim; N(0, &sigma;<sup>2</sup>)
</p>

<p>
称这个过程是高斯白噪声过程，记为WN(0, &sigma;<sup>2</sup>)。
</p>


<p>
下面介绍一阶自回归模型AR(1)：
</p>

<p>
y<sub>t</sub> = c + &alpha; &times; y<sub>t-1</sub> + &epsilon;<sub>t</sub>
</p>

<p>
&epsilon;<sub>t</sub> &sim; WN(0, &sigma;<sup>2</sup>)
</p>

<p>
其中，c叫做截距项或常数项。
</p>

<p>
我们对 y<sub>t</sub> 进行递归展开，可以得到
</p>

<p>
y<sub>t</sub> = (1 + &alpha; + &alpha;<sup>2</sup> + &ctdot; + &alpha;<sup>2</sup>) &times; c + &alpha;<sup>n+1</sup>y<sub>t-n-1</sub> + &epsilon;<sub>t</sub> + &alpha; &epsilon;<sub>t-1</sub> + &ctdot; + &alpha;<sup>n</sup> &epsilon;<sub>t-n</sub>
</p>


<p>
根据前面的描述，我们要求 | &alpha; | &lt; 1，因此，当 n 趋于无穷大时，y<sub>t的极限是</sub>
</p>

<p>
y<sub>t</sub> = c/(1 - &alpha;) +  &epsilon;<sub>t</sub> + &alpha; &epsilon;<sub>t-1</sub> + &ctdot; + &alpha;<sup>n</sup> &epsilon;<sub>t-n</sub>
</p>

<p>
等号右边形式叫做无穷阶移动平均过程（infinite order moving average process）。
</p>

<p>
因为 &epsilon;<sub>t</sub> 是白噪声，均值为0，因此
</p>

<p>
&mu; = E[y<sub>t</sub>] = c/(1-&alpha;)
</p>

<p>
及
</p>

<p>
y<sub>t</sub> - &mu; = &epsilon;<sub>t</sub> + &alpha; &epsilon;<sub>t-1</sub> + &alpha;<sup>2</sup> &epsilon;<sub>t-2</sub> + &ctdot;
</p>

<p>
考虑到y<sub>t的平稳性</sub>，及白噪声的特点（E[&epsilon;<sub>t</sub> &epsilon;<sub>s</sub>]=0, t &ne; s）有
</p>

<p>
&gamma;<sub>0</sub> = E[y<sub>t</sub> - &mu;]<sup>2</sup> = &sigma;<sup>2</sup>/(1 - &alpha;<sup>2</sup>)
</p>

<p>
AR(1)过程的观测值以90%的概率位于&mu; &plusmn; \sqrt{\gamma_0} 的范围内。由于AR(1)围绕着均值运动，因此叫做均值回归（mean-reverting）。
</p>


<p>
下面我们介绍二阶自回归模型AR(2)：
</p>

<p>
y<sub>t</sub> = c + &alpha;<sub>1</sub> y<sub>t-1</sub> + &alpha;<sub>2</sub> y<sub>t-2</sub> + &epsilon;<sub>t</sub>
</p>

<p>
AR(2)平稳的条件是特征方程
</p>

<p>
&lambda;<sup>2</sup> - &alpha;<sub>1</sub> &lambda; - &alpha;<sub>2</sub> = 0
</p>

<p>
的根全部在单位圆内。和AR(1)类似。
</p>


<p>
AR(p)模型：
</p>

<p>
&alpha;(L) y<sub>t</sub> = c+ &epsilon;<sub>t</sub>
</p>

<p>
&alpha;(L) = 1 - &alpha;<sub>1</sub> L - &alpha;<sub>2</sub> L<sup>2</sup> - &ctdot; - &alpha;<sub>p</sub> L<sup>p</sup>
</p>

<p>
如果特征根方程
</p>

<p>
&lambda;<sup>p</sup> - &alpha;<sub>1</sub> &lambda;<sup>p-1</sup> - &ctdot; - &alpha;<sub>p</sub> = 0
</p>

<p>
的根落在单位圆内，AR(p)模型平稳。AR(p)的特性有：
</p>

<p>
&mu; = c/ &alpha;(1)
</p>
</div>
</div>


<div id="outline-container-org76ea2f2" class="outline-2">
<h2 id="org76ea2f2">平稳ARMA模型</h2>
<div class="outline-text-2" id="text-org76ea2f2">
<p>
MA是moving average的缩写。MA(1)模型如下
</p>

<p>
y<sub>t</sub> = c + &epsilon;<sub>t</sub> + &theta;<sub>1</sub> &epsilon;<sub>t-1</sub>
</p>

<p>
用滞后因子表示为：
</p>

<p>
y<sub>t</sub> = c + (1 + &theta;<sub>1</sub>) &epsilon;<sub>t-1</sub>
</p>

<p>
MA(q)模型
</p>

<p>
y<sub>t</sub> = c + &epsilon;<sub>t</sub> + &theta;<sub>1</sub> &epsilon;<sub>t-1</sub> + &ctdot; + &theta;<sub>q</sub> &epsilon;<sub>t-q</sub>
</p>

<p>
&mu; = c
&gamma;<sub>0</sub> = (1+&theta;<sub>1</sub><sup>2</sup> + &ctdot; +&theta;<sub>q</sub><sup>2</sup>) &sigma; ^2
</p>

<p>
ARMA(p,q)模型
&alpha;(L) y<sub>t</sub> = c +&theta;(L) &epsilon;<sub>t</sub>
</p>

<p>
&alpha;(L) = 1 - &alpha;<sub>1</sub> L - &alpha;<sub>2</sub> L<sup>2</sup> - &ctdot; - &alpha;<sub>p</sub> L<sup>p</sup>
&theta;(L) = 1 + &theta;1L + &theta;<sub>2</sub> L<sup>2</sup> + &ctdot; + &theta;<sub>q</sub> L<sup>q</sup>
</p>




<p>
MA(q)是平稳的。ARMA(p,q)的平稳性主要有AR部分决定。对于ARMA(p,q)，如果方程
1 - &alpha;<sub>1</sub> z &alpha;<sub>2</sub> z<sup>2</sup> - &ctdot; - &alpha;<sub>p</sub> z<sup>p</sup> = 0
的一个根在单位圆上，这个ARMA过程叫做自回归单整移动平均过程（autoregressive integrated moving average process），记为ARIMA(p,d,q)。其中d是单整阶数。
</p>

<p>
AR主要关注于时序特征，MA主要关注于冲击因素的影响。AR可以使用最小二乘法OLS进行回归估计，MA和ARMA则需要使用最大似然估计法（maximum likelihood estimation，MLE）。
</p>

<p>
Ljung-Box Q检验（或简称Q检验）用于检验序列相关性（自相关性），可以检验一个过程是否是白噪音。
Breusch-Godfrey LM序列相关性检验。
Durbin-Watson检验。
</p>

<p>
预测准确度度量指标
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">均方误差</td>
<td class="org-left">MSE</td>
<td class="org-left">mean squared error</td>
</tr>

<tr>
<td class="org-left">均方误差平方根</td>
<td class="org-left">RMSE</td>
<td class="org-left">root mean squared error</td>
</tr>

<tr>
<td class="org-left">平均绝对误差</td>
<td class="org-left">MAE</td>
<td class="org-left">mean absolute error</td>
</tr>

<tr>
<td class="org-left">平均绝对百分误差</td>
<td class="org-left">MAPE</td>
<td class="org-left">mean absolute percentage error</td>
</tr>

<tr>
<td class="org-left">Theil不等系数</td>
<td class="org-left">TIC</td>
<td class="org-left">Theil inequality coefficient</td>
</tr>
</tbody>
</table>


<div class="org-src-container">
<pre class="src src-eviews">y ma(1) ar(1)
arma(3,1)建模型应该为y c ar(1) ar(2) ar(3) ma(1)
</pre>
</div>
</div>
</div>

<div id="outline-container-org91064fa" class="outline-2">
<h2 id="org91064fa">试验</h2>
<div class="outline-text-2" id="text-org91064fa">
<p>
试验：建立序列 y<sub>t</sub> = 1+ \sqrt{0.5} y<sub>t-1</sub> + &epsilon;<sub>t</sub>, &epsilon;<sub>t</sub> &sim; N(0,&sigma;<sup>2</sup> ), &sigma;<sup>2</sup> = 0.5
试验：y(t) = c - 0.9y(t-1) + e(t)
</p>

<div class="org-src-container">
<pre class="src src-eviews">
smpl 1970q1 1990q4
equation eq1.ls con c con(-1) inc
smpl 1991q1 1995q4
eq1.fit con_s
eq1.forecast con_d
plot con_s con_d
smpl 1970q1 1990q4
equation eq1.ls con c con(-1) inc
smpl 1991q1 1995q4
eq1.fit con_s
eq1.forecast con_d
plot con_s con_d

equation eq1.ls m1 gdp ar(1) ma(1)
eq1.forecast m1_bj bj_se
eq1.forecast(s) m1_s s_se 
plot bj_se s_se

series y=@nrnd
series x=@nrnd
equation eq.ls y c y(-1) inc
eq.fit y
eq.forecast x
plot x y

</pre>
</div>


<p>
equation eq1.ls m1 gdp ar(1) ma(1)
eq1.forecast m1<sub>bj</sub> bj<sub>se</sub>
eq1.forecast(s) m1<sub>s</sub> s<sub>se</sub> 
plot bj<sub>se</sub> s<sub>se</sub>
</p>

<p>
series y=@nrnd
series x=@nrnd
equation eq.ls y c y(-1) inc
eq.fit y
eq.forecast x
plot x y
</p>

<p>
#+END<sub>SRC</sub>
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2019年02月21日</p>
<p class="date">Created: 2019-09-23 周一 21:12</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
